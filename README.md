# Terraform template for a new Google Cloud project

This repository contains Terraform templates for a new Google Cloud project.
The template contains following settings:

- Service account for Terraform and its IAM role.
- Cloud Storage bucket for the tfstate.
- Cloud Build triggers for Terraform plan (on pull request) and apply (on push).

## Getting started

1. Fork this repository to your own organization.
1. Create a Google Cloud project.
1. Enable billing on the project.
1. Enable Cloud Build API.
1. Connect the forked repository to the project. See also
   [the official document](https://cloud.google.com/build/docs/automating-builds/github/connect-repo-github).
1. Clone the forked repository to your local filesystem or Cloud Shell.
1. Replace all `%CAPITALIZED_STRINGS%` in the following files with your settings:
   - `main.tf`
   - `_locals.tf`
1. Run `terraform init` and `terraform apply` to setup the project.
1. Uncomment the `gcs` block in `main.tf`.
1. Re-run `terraform init` to copy the tfstate to the Cloud Storage bucket.
1. Remove tfstates generated on the local filesystem.
1. Commit all changes to the remote. `.terraform.lock.hcl` generated by Terraform should be included as well.
1. Add branch protection to the main branch with `terraform-plan` status check. It will appear once you proposed some pull request.

After all steps, pull requests on the forked repository will trigger CIs for applying the changes.
